$.fn.replicant=function(e,t){var a=$(this).data("replicantInstance");if(a){switch(e){case"replicate":return a.replicate(t,!1);case"clear":return a.clear();case"setModel":return a.setModel(t)}if(console.log("verificando instance",a,$(this)),e&&e.values){a.clear();for(var r=0;r<e.values.length;r++)a.replicate(e.values[r],0==r)}return console.log("nao vou fazer naada.. saindo"),a}var n=$(this);n=$(n);var s=this;if(this.totalItems=0,this.model=$(".replicant-base",n).prop("outerHTML"),this.container=n,this.qtd=1,this.constructorParams=e,this.setModel=function(e){return this.model=e,this},this.clear=function(){return this.container.html(this.model),$(".replicant-remove",this.container).hide(),this.qtd=1,this.constructorParams&&this.constructorParams.onRender&&this.constructorParams.onRender($(".replicant-base:last",$(this))),this},$(".replicant-remove",n).hide(),n.delegate(".replicant-add","click",function(){s.replicate()}),n.delegate(".replicant-clear","click",function(){s.clear()}),n.delegate(".replicant-remove","click",function(){s.qtd--;var e=$(this).closest(".replicant-base");if(e.is(":last-child")){var t=e.prev(".replicant-base");$(".replicant-add",t).show(),$(".replicant-clear",t).show()}var a=e.parent();e.remove(),1==$(".replicant-base",a).length&&$(".replicant-remove",a).hide()}),s.constructorParams&&s.constructorParams.onRender&&s.constructorParams.onRender($(".replicant-base:last",$(this))),n.data("replicantInstance",this),this.replicate=function(e,t){if(!this.constructorParams||!this.constructorParams.onBeforeRender||this.constructorParams.onBeforeRender(e,s.qtd)){if(s.qtd++,t||this.container.append(this.model),$(".replicant-remove",this.container).show(),$(".replicant-add",this.container).not(":last").hide(),$(".replicant-clear",this.container).not(":last").hide(),e)for(var a in e)$('[name="'+a+'"]',$(".replicant-base:last",this.container)).val(e[a]),console.log("campo: ",a,e[a],$('[name="'+a+'"]',$(".replicant-base",this.container)),$('[name="'+a+'"]',$(".replicant-base",this.container)).length);s.constructorParams&&s.constructorParams.onRender&&s.constructorParams.onRender($(".replicant-base:last",$(this)))}},e&&e.values)for(var r=0;r<e.values.length;r++)this.replicate(e.values[r],0==r)};
